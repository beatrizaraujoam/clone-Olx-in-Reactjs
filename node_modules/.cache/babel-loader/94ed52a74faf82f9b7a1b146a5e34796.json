{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\beatriz.araujo\\\\Downloads\\\\react-olx-main\\\\src\\\\pages\\\\AddAd\\\\index.js\",\n    _s = $RefreshSig$();\n\nimport React, { useRef, useState, useEffect } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport useApi from '../../helpers/OLXApi';\nimport MaskedInput from 'react-text-mask';\nimport createNumberMask from 'text-mask-addons/dist/createNumberMask';\nimport { PageArea } from './style';\nimport { PageContainer, PageTitle, ErrorMessage } from '../../components';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Page = () => {\n  _s();\n\n  const api = useApi();\n  const history = useHistory();\n  const fileField = useRef();\n  const [title, setTitle] = useState('');\n  const [category, setCategory] = useState('');\n  const [categories, setCategories] = useState([]);\n  const [price, setPrice] = useState('');\n  const [priceNegotiable, setPriceNegotiable] = useState(false);\n  const [description, setDescription] = useState('');\n  const [disabled, setDisabled] = useState(false);\n  const [error, setError] = useState('');\n  useEffect(() => {\n    const getCategories = async () => {\n      const categories = await api.getCategories();\n      setCategories(categories);\n    };\n\n    getCategories(); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const handleSubmit = async e => {\n    e.preventDefault();\n    setError('');\n\n    if (title && category && (price || priceNegotiable) && description) {\n      const fData = new FormData();\n      fData.append('title', title);\n      fData.append('category', category);\n      fData.append('price', price);\n      fData.append('price_negotiable', priceNegotiable);\n      fData.append('description', description);\n\n      if (fileField.current.files.length > 0) {\n        for (let i = 0; i < fileField.current.files.length; i++) {\n          fData.append('image', fileField.current.files[i]);\n        }\n\n        ;\n      }\n\n      ;\n      setDisabled(true);\n      const json = await api.addAd(fData);\n\n      if (json.error) {\n        const jsonErrors = [];\n\n        for (let err in json.error) {\n          console.log(err.msg);\n          jsonErrors.push(json.error[err].msg);\n        }\n\n        ;\n        setError(jsonErrors.join(', '));\n      } else {\n        history.push(`/ad/${json.public_id}`);\n        return;\n      }\n\n      ;\n    } else {\n      setError('Preencha todos os campos.');\n    }\n\n    ;\n    setDisabled(false);\n  };\n\n  const priceMask = createNumberMask({\n    prefix: 'R$ ',\n    includeThousandsSeparator: true,\n    thousandsSeparatorSymbol: '.',\n    allowDecimal: true,\n    decimalSymbol: ','\n  });\n  return /*#__PURE__*/_jsxDEV(PageContainer, {\n    children: [/*#__PURE__*/_jsxDEV(PageTitle, {\n      children: \"Postar um An\\xFAncio\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(PageArea, {\n      children: [error && /*#__PURE__*/_jsxDEV(ErrorMessage, {\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 19\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit,\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"area\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"area--title\",\n            children: \"T\\xEDtulo:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 88,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"area--input\",\n            children: /*#__PURE__*/_jsxDEV(\"input\", {\n              autoFocus: true,\n              type: \"text\",\n              disabled: disabled,\n              value: title,\n              onChange: e => setTitle(e.target.value)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 90,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 89,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"area\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"area--title\",\n            children: \"Categoria:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 100,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"area--input\",\n            children: /*#__PURE__*/_jsxDEV(\"select\", {\n              disabled: disabled,\n              onChange: e => setCategory(e.target.value),\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 106,\n                columnNumber: 17\n              }, this), categories.map((item, key) => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: item.slug,\n                children: item.name\n              }, key, false, {\n                fileName: _jsxFileName,\n                lineNumber: 108,\n                columnNumber: 19\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 102,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"area\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"area--title\",\n            children: \"Pre\\xE7o:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"area--input\",\n            children: /*#__PURE__*/_jsxDEV(MaskedInput, {\n              mask: priceMask,\n              placeholder: \"R$ \",\n              disabled: disabled || priceNegotiable,\n              value: price,\n              onChange: e => setPrice(e.target.value)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 116,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 115,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"area\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"area--title\",\n            children: \"Pre\\xE7o negoci\\xE1vel?\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 126,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"area--input\",\n            children: /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"checkbox\",\n              disabled: disabled,\n              checked: priceNegotiable,\n              onChange: () => setPriceNegotiable(!priceNegotiable)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 128,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 127,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"area\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"area--title\",\n            children: \"Descri\\xE7\\xE3o:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 137,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"area--input\",\n            children: /*#__PURE__*/_jsxDEV(\"textarea\", {\n              disabled: disabled,\n              value: description,\n              onChange: e => setDescription(e.target.value)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 139,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 138,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"area\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"area--title\",\n            children: \"Imagens (1 ou mais):\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 147,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"area--input\",\n            children: /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"file\",\n              disabled: disabled,\n              ref: fileField,\n              multiple: true,\n              accept: \"image/jpg, image/jpeg, image/png, image/webp\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 149,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 148,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"area\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"area--title\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 159,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"area--input\",\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              disabled: disabled,\n              children: \"Adicionar an\\xFAncio\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 161,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 160,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 82,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Page, \"PWljTGHKO5YoHZCLwmG+JcrcAyQ=\", false, function () {\n  return [useApi, useHistory];\n});\n\n_c = Page;\nexport default Page;\n\nvar _c;\n\n$RefreshReg$(_c, \"Page\");","map":{"version":3,"sources":["C:/Users/beatriz.araujo/Downloads/react-olx-main/src/pages/AddAd/index.js"],"names":["React","useRef","useState","useEffect","useHistory","useApi","MaskedInput","createNumberMask","PageArea","PageContainer","PageTitle","ErrorMessage","Page","api","history","fileField","title","setTitle","category","setCategory","categories","setCategories","price","setPrice","priceNegotiable","setPriceNegotiable","description","setDescription","disabled","setDisabled","error","setError","getCategories","handleSubmit","e","preventDefault","fData","FormData","append","current","files","length","i","json","addAd","jsonErrors","err","console","log","msg","push","join","public_id","priceMask","prefix","includeThousandsSeparator","thousandsSeparatorSymbol","allowDecimal","decimalSymbol","target","value","map","item","key","slug","name"],"mappings":"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","sourcesContent":["import React, { useRef, useState, useEffect } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport useApi from '../../helpers/OLXApi';\nimport MaskedInput from 'react-text-mask';\nimport createNumberMask from 'text-mask-addons/dist/createNumberMask';\nimport { PageArea } from './style';\nimport { PageContainer, PageTitle, ErrorMessage } from '../../components';\n\nconst Page = () => {\n  const api = useApi();\n  const history = useHistory();\n\n  const fileField = useRef();\n\n  const [title, setTitle] = useState('');\n  const [category, setCategory] = useState('');\n  const [categories, setCategories] = useState([]);\n  const [price, setPrice] = useState('');\n  const [priceNegotiable, setPriceNegotiable] = useState(false)\n  const [description, setDescription] = useState('');\n  const [disabled, setDisabled] = useState(false);\n  const [error, setError] = useState('');\n\n  useEffect(() => {\n    const getCategories = async () => {\n      const categories = await api.getCategories();\n      setCategories(categories);\n    };\n    getCategories();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const handleSubmit = async e => {\n    e.preventDefault();\n    setError('');\n\n    if (title && category && (price || priceNegotiable) && description) {\n      const fData = new FormData();\n      fData.append('title', title);\n      fData.append('category', category);\n      fData.append('price', price);\n      fData.append('price_negotiable', priceNegotiable);\n      fData.append('description', description);\n      \n      if(fileField.current.files.length > 0) {\n        for(let i = 0; i < fileField.current.files.length; i++){\n          fData.append('image', fileField.current.files[i]);\n        };\n      };\n\n      setDisabled(true);\n      const json = await api.addAd(fData);\n\n      if (json.error) {\n        const jsonErrors = [];\n        for(let err in json.error){\n          console.log(err.msg);\n          jsonErrors.push(json.error[err].msg);\n        };\n\n        setError(jsonErrors.join(', '));\n      } else {\n        history.push(`/ad/${json.public_id}`);\n        return;\n      };\n    } else {\n      setError('Preencha todos os campos.')\n    };\n\n    setDisabled(false);\n  };\n\n  const priceMask = createNumberMask({\n    prefix: 'R$ ',\n    includeThousandsSeparator: true,\n    thousandsSeparatorSymbol: '.',\n    allowDecimal: true,\n    decimalSymbol: ',',\n  });\n\n  return (\n    <PageContainer>\n      <PageTitle>Postar um Anúncio</PageTitle>\n      <PageArea>\n        {error && <ErrorMessage>{error}</ErrorMessage>}\n        <form onSubmit={handleSubmit}>\n          <label className=\"area\">\n            <div className=\"area--title\">Título:</div>\n            <div className=\"area--input\">\n              <input\n                autoFocus\n                type=\"text\"\n                disabled={disabled}\n                value={title}\n                onChange={e => setTitle(e.target.value)}\n              />\n            </div>\n          </label>\n          <label className=\"area\">\n            <div className=\"area--title\">Categoria:</div>\n            <div className=\"area--input\">\n              <select\n                disabled={disabled}\n                onChange={e => setCategory(e.target.value)}\n              >\n                <option></option>\n                {categories.map((item, key) => (\n                  <option key={key} value={item.slug}>{item.name}</option>\n                ))}\n              </select>\n            </div>\n          </label>\n          <label className=\"area\">\n            <div className=\"area--title\">Preço:</div>\n            <div className=\"area--input\">\n              <MaskedInput\n                mask={priceMask}\n                placeholder=\"R$ \"\n                disabled={disabled || priceNegotiable}\n                value={price}\n                onChange={e => setPrice(e.target.value)}\n              />\n            </div>\n          </label>\n          <label className=\"area\">\n            <div className=\"area--title\">Preço negociável?</div>\n            <div className=\"area--input\">\n              <input\n                type=\"checkbox\"\n                disabled={disabled}\n                checked={priceNegotiable}\n                onChange={() => setPriceNegotiable(!priceNegotiable)}\n              />\n            </div>\n          </label>\n          <label className=\"area\">\n            <div className=\"area--title\">Descrição:</div>\n            <div className=\"area--input\">\n              <textarea\n                disabled={disabled}\n                value={description}\n                onChange={(e) => setDescription(e.target.value)}\n              ></textarea>\n            </div>\n          </label>\n          <label className=\"area\">\n            <div className=\"area--title\">Imagens (1 ou mais):</div>\n            <div className=\"area--input\">\n              <input\n                type=\"file\"\n                disabled={disabled}\n                ref={fileField}\n                multiple\n                accept=\"image/jpg, image/jpeg, image/png, image/webp\"\n              />\n            </div>\n          </label>\n          <label className=\"area\">\n            <div className=\"area--title\"></div>\n            <div className=\"area--input\">\n              <button disabled={disabled}>Adicionar anúncio</button>\n            </div>\n          </label>\n        </form>\n      </PageArea>\n    </PageContainer>\n  );\n};\n\nexport default Page;"]},"metadata":{},"sourceType":"module"}