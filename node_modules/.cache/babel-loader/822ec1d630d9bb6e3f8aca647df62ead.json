{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\beatriz.araujo\\\\Downloads\\\\react-olx-main\\\\src\\\\pages\\\\Ads\\\\index.js\",\n    _s2 = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport useApi from '../../helpers/OLXApi';\nimport { PageArea, Fake } from './style';\nimport { PageContainer } from '../../components';\nimport { useLocation, useHistory } from 'react-router-dom';\nimport { AdItem } from '../../components';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nlet timer;\n\nconst Page = () => {\n  _s2();\n\n  var _s = $RefreshSig$();\n\n  const api = useApi();\n  const history = useHistory();\n\n  const useQueryString = () => {\n    _s();\n\n    return new URLSearchParams(useLocation().search);\n  };\n\n  _s(useQueryString, \"EuD9q2dZ34PfN/QO2OBhBzeMxmY=\", false, function () {\n    return [useLocation];\n  });\n\n  const query = useQueryString();\n  const [q, setQ] = useState('');\n  const [cat, setCat] = useState('');\n  const [state, setState] = useState('');\n  const [stateList, setStateList] = useState([]);\n  const [categories, setCategories] = useState([]);\n  const [adList, setAdList] = useState([]);\n  const [adsTotal, setAdsTotal] = useState(0);\n  const [pagination, setPagination] = useState([]);\n  const [lastPageDisplay, setLastPageDisplay] = useState(false);\n  const [nextPageDisplay, setNextPageDisplay] = useState(false);\n  const [currentPage, setCurrentPage] = useState(null);\n  const [resultOpacity, setResultOpacity] = useState(1);\n  const [warningMessage, setWarningMessage] = useState('');\n  const [error, setError] = useState(false);\n  const [loading, setLoading] = useState(true);\n\n  const getAdsList = async () => {\n    setError(false);\n    setAdList([]);\n    const LIMIT = 15;\n    const offset = currentPage ? (currentPage - 1) * LIMIT : 0;\n    const json = await api.getAds({\n      sort: 'desc',\n      limit: LIMIT,\n      q,\n      cat,\n      state,\n      offset\n    });\n\n    if (json.error) {\n      const jsonErrors = [];\n\n      for (let err in json.error) {\n        jsonErrors.push(json.error[err].msg);\n      }\n\n      ;\n      setError(true);\n      setWarningMessage(jsonErrors.join(', '));\n    } else {\n      setAdList(json.ads);\n      setAdsTotal(json.total);\n      setResultOpacity(1);\n      setWarningMessage('');\n      setError(false);\n    }\n\n    ;\n  };\n\n  useEffect(() => {\n    setAdList([]);\n  }, []);\n  useEffect(() => {\n    const queryQ = query.get('q');\n    const queryCat = query.get('cat');\n    const queryState = query.get('state');\n    queryQ && setQ(queryQ);\n    queryCat && setCat(queryCat);\n    queryState && setState(queryState); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  useEffect(() => {\n    const getStates = async () => {\n      const stateList = await api.getStates();\n      setStateList(stateList);\n    };\n\n    const getCategories = async () => {\n      const stateList = await api.getCategories();\n      setCategories(stateList);\n      setLoading(false);\n    };\n\n    getStates();\n    getCategories(); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  useEffect(() => {\n    setWarningMessage('Carregando...');\n    setPagination([]);\n    const queryString = [];\n    q && queryString.push(`q=${q}`);\n    cat && queryString.push(`cat=${cat}`);\n    state && queryString.push(`state=${state}`);\n    history.replace({\n      search: `?${queryString.join('&')}`\n    });\n\n    if (timer) {\n      clearTimeout(timer);\n    }\n\n    ;\n    timer = setTimeout(getAdsList, 500);\n    setCurrentPage(1);\n    setResultOpacity(0.5); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [q, cat, state, history]);\n  useEffect(() => {\n    setLastPageDisplay(false);\n    setNextPageDisplay(false);\n    window.scrollTo({\n      top: 0,\n      left: 0,\n      behavior: 'smooth'\n    });\n\n    if (adList.length > 0) {\n      const pageCount = Math.ceil(adsTotal / adList.length);\n      const pageCountArray = [];\n\n      if (currentPage === 1) {\n        for (let i = 1; i <= pageCount && i <= 3; i++) {\n          pageCountArray.push(i);\n        }\n\n        ;\n        setNextPageDisplay(true);\n      } else if (currentPage > 1 && currentPage < pageCount) {\n        for (let i = currentPage - 1; i <= currentPage + 1; i++) {\n          pageCountArray.push(i);\n        }\n\n        ;\n        setLastPageDisplay(true);\n        setNextPageDisplay(true);\n      } else if (currentPage === 2 & pageCount === 2) {\n        for (let i = currentPage - 1; i <= currentPage; i++) {\n          pageCountArray.push(i);\n        }\n\n        ;\n        setLastPageDisplay(true);\n      } else {\n        for (let i = currentPage - 2; i <= currentPage; i++) {\n          pageCountArray.push(i);\n        }\n\n        ;\n        setLastPageDisplay(true);\n      }\n\n      ;\n      setPagination(pageCountArray);\n    } else {\n      setPagination([]);\n    }\n\n    ;\n  }, [adsTotal, adList, currentPage]);\n  useEffect(() => {\n    if (currentPage) {\n      setResultOpacity(0.5);\n      getAdsList();\n    }\n\n    ; // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [currentPage]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(PageContainer, {\n      children: /*#__PURE__*/_jsxDEV(PageArea, {\n        resultOpacity: resultOpacity,\n        lastPageDisplay: lastPageDisplay,\n        nextPageDisplay: nextPageDisplay,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"leftSide\",\n          children: /*#__PURE__*/_jsxDEV(\"form\", {\n            method: \"GET\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              name: \"q\",\n              placeholder: \"O que voc\\xEA procura?\",\n              value: q,\n              onChange: e => setQ(e.target.value)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 182,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"filterName\",\n              children: \"Estado:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 190,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              name: \"state\",\n              value: state,\n              onChange: e => setState(e.target.value),\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                children: \"Selecione seu estado\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 192,\n                columnNumber: 17\n              }, this), stateList.map((item, key) => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: item.uf,\n                children: item.uf\n              }, key, false, {\n                fileName: _jsxFileName,\n                lineNumber: 194,\n                columnNumber: 19\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 191,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"filterName\",\n              children: \"Categoria:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 198,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n              children: loading ? /*#__PURE__*/_jsxDEV(Fake, {\n                height: \"200\",\n                fillContent: true\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 200,\n                columnNumber: 28\n              }, this) : categories.map((item, key) => /*#__PURE__*/_jsxDEV(\"li\", {\n                className: `categoryItem ${cat === item.slug && 'active'}`,\n                onClick: () => setCat(item.slug),\n                children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                  src: item.img,\n                  alt: item.name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 207,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: item.name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 208,\n                  columnNumber: 21\n                }, this)]\n              }, key, true, {\n                fileName: _jsxFileName,\n                lineNumber: 202,\n                columnNumber: 19\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 199,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 181,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"rightSide\",\n          children: [warningMessage && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"listWarning\",\n            children: warningMessage\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 216,\n            columnNumber: 32\n          }, this), error === false && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"list\",\n            children: adList.map((item, key) => /*#__PURE__*/_jsxDEV(AdItem, {\n              data: item\n            }, key, false, {\n              fileName: _jsxFileName,\n              lineNumber: 220,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 218,\n            columnNumber: 15\n          }, this), pagination.length > 1 && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"pagination\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              onClick: () => lastPageDisplay && setCurrentPage(currentPage - 1),\n              className: \"pagItem lastPage\",\n              children: \"<\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 226,\n              columnNumber: 17\n            }, this), pagination.map((item, key) => /*#__PURE__*/_jsxDEV(\"div\", {\n              onClick: () => setCurrentPage(item),\n              className: item === currentPage ? 'pagItem active' : 'pagItem',\n              children: item\n            }, key, false, {\n              fileName: _jsxFileName,\n              lineNumber: 232,\n              columnNumber: 19\n            }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n              onClick: () => nextPageDisplay && setCurrentPage(currentPage + 1),\n              className: \"pagItem nextPage\",\n              children: \">\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 240,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 225,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 215,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 7\n    }, this)\n  }, void 0, false);\n};\n\n_s2(Page, \"GItFUYY5aadgFtydO0EN/D6PmEA=\", true, function () {\n  return [useApi, useHistory];\n});\n\n_c = Page;\nexport default Page;\n\nvar _c;\n\n$RefreshReg$(_c, \"Page\");","map":{"version":3,"sources":["C:/Users/beatriz.araujo/Downloads/react-olx-main/src/pages/Ads/index.js"],"names":["React","useState","useEffect","useApi","PageArea","Fake","PageContainer","useLocation","useHistory","AdItem","timer","Page","api","history","useQueryString","URLSearchParams","search","query","q","setQ","cat","setCat","state","setState","stateList","setStateList","categories","setCategories","adList","setAdList","adsTotal","setAdsTotal","pagination","setPagination","lastPageDisplay","setLastPageDisplay","nextPageDisplay","setNextPageDisplay","currentPage","setCurrentPage","resultOpacity","setResultOpacity","warningMessage","setWarningMessage","error","setError","loading","setLoading","getAdsList","LIMIT","offset","json","getAds","sort","limit","jsonErrors","err","push","msg","join","ads","total","queryQ","get","queryCat","queryState","getStates","getCategories","queryString","replace","clearTimeout","setTimeout","window","scrollTo","top","left","behavior","length","pageCount","Math","ceil","pageCountArray","i","e","target","value","map","item","key","uf","slug","img","name"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport useApi from '../../helpers/OLXApi';\nimport { PageArea, Fake } from './style';\nimport { PageContainer } from '../../components';\nimport { useLocation, useHistory } from 'react-router-dom';\nimport { AdItem } from '../../components';\n\nlet timer;\n\nconst Page = () => {\n  const api = useApi();\n  const history = useHistory();\n\n  const useQueryString = () => {\n    return new URLSearchParams(useLocation().search);\n  };\n\n  const query = useQueryString();\n\n  const [q, setQ] = useState('');\n  const [cat, setCat] = useState('');\n  const [state, setState] = useState('');\n  const [stateList, setStateList] = useState([]);\n  const [categories, setCategories] = useState([]);\n  const [adList, setAdList] = useState([]);\n  const [adsTotal, setAdsTotal] = useState(0);\n  const [pagination, setPagination] = useState([]);\n  const [lastPageDisplay, setLastPageDisplay] = useState(false);\n  const [nextPageDisplay, setNextPageDisplay] = useState(false);\n  const [currentPage, setCurrentPage] = useState(null);\n  const [resultOpacity, setResultOpacity] = useState(1);\n  const [warningMessage, setWarningMessage] = useState('');\n  const [error, setError] = useState(false);\n  const [loading, setLoading] = useState(true);\n\n  const getAdsList = async () => {\n    setError(false);\n    setAdList([]);\n\n    const LIMIT = 15;\n    const offset = currentPage ? (currentPage - 1) * LIMIT : 0;\n\n    const json = await api.getAds({\n      sort: 'desc',\n      limit: LIMIT,\n      q,\n      cat,\n      state,\n      offset,\n    });\n    if (json.error) {\n      const jsonErrors = [];\n      for (let err in json.error) {\n        jsonErrors.push(json.error[err].msg);\n      };\n\n      setError(true);\n      setWarningMessage(jsonErrors.join(', '));\n    } else {\n      setAdList(json.ads);\n      setAdsTotal(json.total);\n      setResultOpacity(1);\n      setWarningMessage('');\n      setError(false);\n    };\n  };\n\n  useEffect(() => {\n    setAdList([]);\n  }, [])\n\n  useEffect(() => {\n    const queryQ = query.get('q');\n    const queryCat = query.get('cat');\n    const queryState = query.get('state');\n\n    queryQ && setQ(queryQ);\n    queryCat && setCat(queryCat);\n    queryState && setState(queryState);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  useEffect(() => {\n    const getStates = async () => {\n      const stateList = await api.getStates();\n      setStateList(stateList);\n    };\n    const getCategories = async () => {\n      const stateList = await api.getCategories();\n      setCategories(stateList);\n      setLoading(false);\n    };\n    getStates();\n    getCategories();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  useEffect(() => {\n    setWarningMessage('Carregando...');\n    setPagination([]);\n\n    const queryString = [];\n    q && queryString.push(`q=${q}`);\n    cat && queryString.push(`cat=${cat}`);\n    state && queryString.push(`state=${state}`);\n\n    history.replace({\n      search: `?${queryString.join('&')}`,\n    });\n\n    if (timer) {\n      clearTimeout(timer);\n    };\n\n    timer = setTimeout(getAdsList, 500);\n    setCurrentPage(1);\n    setResultOpacity(0.5);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [q, cat, state, history]);\n\n  useEffect(() => {\n    setLastPageDisplay(false);\n    setNextPageDisplay(false);\n\n    window.scrollTo({\n      top: 0,\n      left: 0,\n      behavior: 'smooth',\n    });\n\n    if (adList.length > 0) {\n      const pageCount = (Math.ceil(adsTotal / adList.length));\n      const pageCountArray = [];\n\n      if (currentPage === 1) {\n        for (let i = 1; i <= pageCount && i <= 3; i++) {\n          pageCountArray.push(i);\n        };\n        setNextPageDisplay(true);\n      } else if (currentPage > 1 && currentPage < pageCount) {\n        for (let i = currentPage - 1; i <= currentPage + 1; i++) {\n          pageCountArray.push(i);\n        };\n        setLastPageDisplay(true);\n        setNextPageDisplay(true);\n      } else if (currentPage === 2 & pageCount === 2) {\n        for (let i = currentPage - 1; i <= currentPage; i++) {\n          pageCountArray.push(i);\n        };\n        setLastPageDisplay(true);\n      } else {\n        for (let i = currentPage - 2; i <= currentPage; i++) {\n          pageCountArray.push(i);\n        };\n        setLastPageDisplay(true);\n      };\n\n      setPagination(pageCountArray);\n    } else {\n      setPagination([]);\n    };\n  }, [adsTotal, adList, currentPage]);\n\n  useEffect(() => {\n    if(currentPage) {\n      setResultOpacity(0.5);\n      getAdsList();\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [currentPage]);\n\n  return (\n    <>\n      <PageContainer>\n        <PageArea\n          resultOpacity={resultOpacity}\n          lastPageDisplay={lastPageDisplay}\n          nextPageDisplay={nextPageDisplay}\n        >\n          <div className=\"leftSide\">\n            <form method=\"GET\">\n              <input\n                type=\"text\"\n                name=\"q\"\n                placeholder=\"O que você procura?\"\n                value={q}\n                onChange={e => setQ(e.target.value)}\n              />\n\n              <div className=\"filterName\">Estado:</div>\n              <select name=\"state\" value={state} onChange={e => setState(e.target.value)}>\n                <option>Selecione seu estado</option>\n                {stateList.map((item, key) => (\n                  <option key={key} value={item.uf}>{item.uf}</option>\n                ))}\n              </select>\n\n              <div className=\"filterName\">Categoria:</div>\n              <ul>\n                {loading ? <Fake height=\"200\" fillContent/>\n                : categories.map((item, key) => (\n                  <li\n                    key={key}\n                    className={`categoryItem ${cat === item.slug && 'active'}`}\n                    onClick={() => setCat(item.slug)}\n                  >\n                    <img src={item.img} alt={item.name} />\n                    <span>{item.name}</span>\n                  </li>\n                ))\n                }\n              </ul>\n            </form>\n          </div>\n          <div className=\"rightSide\">\n            {warningMessage && <div className=\"listWarning\">{warningMessage}</div>}\n            {error === false &&\n              <div className=\"list\">\n                {adList.map((item, key) => (\n                  <AdItem key={key} data={item}></AdItem>\n                ))}\n              </div>\n            }\n            {pagination.length > 1 &&\n              <div className=\"pagination\">\n                <div onClick={() => lastPageDisplay && setCurrentPage(currentPage - 1)}\n                  className='pagItem lastPage'\n                >\n                  &lt;\n                  </div>\n                {pagination.map((item, key) => (\n                  <div\n                    onClick={() => setCurrentPage(item)}\n                    className={item === currentPage ? 'pagItem active' : 'pagItem'}\n                    key={key}\n                  >\n                    {item}\n                  </div>\n                ))}\n                <div\n                  onClick={() => nextPageDisplay && setCurrentPage(currentPage + 1)}\n                  className='pagItem nextPage'\n                >\n                  &gt;\n                </div>\n              </div>\n            }\n          </div>\n        </PageArea>\n      </PageContainer>\n    </>\n  );\n};\n\nexport default Page;"]},"metadata":{},"sourceType":"module"}